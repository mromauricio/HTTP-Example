<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
  <div>
    <label>Input GET</label>
    <input id="inputget" type="text">
  </div>
  <button id="enviaGet" type="button">Enviar GET</button>
  <hr>
  <div>
    <label>Input POST</label>
    <input id="inputpost" type="text" style="width: 600px;">
  </div>
  <button id="enviaPost" type="button">Enviar POST</button>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  
  <script>
   // let conteudoInputGet = document.getElementById('inputget').value
    
    let conteudoInputGet = document.querySelector('#inputget');
    let buttonEnviaGet = document.querySelector('#enviaGet'); 
    let conteudoInputPost = document.querySelector('#inputpost');
    let buttonEnviaPost = document.querySelector('#enviaPost'); 

    buttonEnviaGet.addEventListener('click', function(){
      switch (conteudoInputGet.value){
        case '1':
          Get1(); break;

        case '2':  
          Get2(); break;

        case '3':  
          GetJson(); break;  

        default:
          GetDefault(conteudoInputGet.value); break;
      }
    });

    buttonEnviaPost.addEventListener('click', function(){
      Post1(conteudoInputPost.value);
    });


   async  function Get1(){  
      console.log('Via Fetch')
      let url =  new URL('http://localhost:3000/destino1');
      let response =  await fetch(url);
      //console.log('Response completo', response);
      console.log('Status response: ',response.status);
      let data = await response.text();
      console.log ('Texto response: ',data)  
    }

    async function xxxxGet2(){  
      console.log('Via Fetch')
      let url =  new URL('http://localhost:3000/destino2');
      let response = await fetch(url);
      console.log ('Status response: ',response.status);
      let data = await response.text();
      console.log ('Texto response: ',data)  
    }

    //   jQuery AJAX - (A)synchronous (JA)vaScript and (X)ML
    function Get2(){
      console.log('Via Ajax');
      let url = new URL('http://localhost:3000/destino2');
      $.get(url, function(result, status, response){
        console.log(response.status)
        let data = response.responseText
        console.log (data);
      });
    }
    
    async function GetJson(){  
      console.log('Via Fetch');
      let url =  new URL('http://localhost:3000/destino3');
      let response = await fetch(url);
      console.log (response.status);
      let data = await response.json();
      // console.log(data);
      for (i=0; i<data.length; i++){
        console.log ('Nome: ', data[i].nome,'    CPF: ', data[i].cpf);
      }
    }

    //   jQuery AJAX - (A)synchronous (JA)vaScript and (X)ML
    function AJAX_GetJson(){
      console.log('Via Ajax');
      let url = new URL('http://localhost:3000/destino3');
      $.get(url, function(result, status, response){
        console.log(response.status)
        let data = response.responseJSON
        for (i=0; i<data.length; i++){
        console.log ('Nome: ', data[i].nome, '    CPF: ', data[i].cpf);
        }
      });
    }

    async function GetDefault(parametro){  
      console.log('Via Fetch');
      let url =  new URL('http://localhost:3000/destino4');
      url += `/?nome=${parametro}`
      let response = await fetch(url);
      console.log (response.status);
      if (response.status==200) {
        console.log (`Nome ${parametro} localizado no servidor`);
      }
      else console.log (`Nome ${parametro} NÃƒO localizado no servidor`);
    }

    async function FETCHPost1 (parametro){
      console.log('Via Fetch');
      let url =  new URL('http://localhost:3000/destino1');
      let response = await fetch(url, {
        method: 'POST',
        headers: {'Content-Type': 'application/json;charset=utf-8'},
        body: parametro
      })
      switch (response.status){
        case 201: 
          console.log ('Sucesso no envio do Json para o servidor'); break;
        case 406:
          console.log ('Corrija o dado enviado'); break;
        }
    }

    function Post1(parametro){
      console.log('Via Ajax');
      let url = new URL('http://localhost:3000/destino1');
    $.post({
          url: url,
          data: parametro,
          contentType: "application/json; charset=utf-8",
          dataType: "json"
      });
    }
       
  </script>
</body>
</html>